# Проект по обработке BAM файлов на основе Python

## Содержание

- [Введение](#введение)
- [Входные файлы](#входные-файлы)
- [Необходимые библиотеки](#необходимые-библиотеки)
- [Реализация интерфейса](#реализация-интерфейса)
  
## Введение

Данное приложение в перспективе позволит рассчитывать частоты замены нуклеотидов в последовательности РНК, а именно уровень РНК-редактирования.
У человека редактирование РНК происходит путем дезаминирования цитозина в урацил (C-to-U) или, в основном, путем преобразования аденозина в инозин (A-to-I) с помощью ферментов ADAR. 
Данные замены могут иметь пагубные последствия и связаны с различными заболеваниями человека, включая неврологические и нейродегенеративные заболевания или злокачественные новообразования.

На изображении внизу представлен общий алгоритм.

![Figure_RNAed](https://github.com/user-attachments/assets/de58a8a1-9c7a-4a93-bb53-b070b4fac652)

Однако для начала необходимо точно определить тип и статус входных файлов (первая итерация). 

## Входные файлы

Для учета РНК-редактирования необходим анализ файлов, полученными с помощью технологий высокопроизводительного секвенирования РНК/ДНК:

- BAM файл, содержащий риды (прочтения с последовательностью нуклеотидов длиной до 150-200 нуклеотидов), которые выровнены на референсный геном, и соответсвующий BAI файл с индексами для учета координат каждого рида (обязательно);
- FASTA файл референсный геном и соответсвующий FAI файл (обязательно);
- BED файл, содержащий регионы для анализа замен определенных нукелотидов (опционально).

## Необходимые библиотеки

- os - бибилотека для определения времени создания файлов и путей в файловой системе
- flet - библиотека для создания интерфейсов
- pysam - бибилотека для работы с BAM файлами
- pandas - бибилотека для работы с табличными данными
- argparse - бибилотека для написания программ, которые могут принимать параметры командной строки

## Реализация интерфейса

Основной файл приложения на данный момент - **bam_processing.py**, который отрисовывает с помощью пакета flet окно приложения. Суть работы программы на данный момент заключается в том, что она проверяет поданные на вход файлы.
Данная процедура необходима для правильной работы пакета pysam, с помощью которого будет высчитываться уровень РНК-редактирования и дополнительная статистика (качество данных и тд).
Обязательно, помимо наличия 4 файлов из раздела выше, совпадение в названии файлов BAM и BAI, а также условие, что BAI файл создан после BAM файла (это логично, поскольку индексы строятся именно на основе BAM файла).
В противном случае будет выводиться соответсвующий текст ошибки. 
При корректной работе программы и наличии всех файлов (примеры файлов лежат в папке **./example**) будет выводиться размер BAM файла.
Для практики в папке представлен BAM файл с правильным BAI индексом (SRR2135332.bam и SRR2135332.bam.bai) и BAM файл, для которого BAI индекс был создан раньше (SRR2135332_too_late.bam и SRR2135332_too_late.bam.bai).

Примечательно, что кнопка "Подтвердить загрузку" становится активной только после выбора файлов кнопкой "Выбрать файлы".
При этом есть возможность очистить интерфейс кнопкой "Очистить".

В будущем, когда будет необходимо посчитать РНК-редактирование в определенном регионе/позиции, может потребоваться BED файл, в котором задаются координаты генома. 
Каждый регион представлен отдельной строкой в виде трех колонок (через знак табуляции): название хромосомы, начало интервала и конец интервала.
При наличии данного файла и его загрузке приложение выводит количество регионов (строк) для последующего анализа.

Результат корректного вывода программы представлен внизу.

![Интерфейс_приложения](https://github.com/user-attachments/assets/ccb3fd26-40de-493c-8e4e-ae13d324721e)
